{"version":3,"sources":["webpack:///./js/getRefs.js","webpack:///./js/renderForm.js","webpack:///./js/renderImagesGallery.js","webpack:///./js/apiService.js","webpack:///./index.js","webpack:///./templates/images.hbs","webpack:///./templates/form.hbs"],"names":["getRefs","gallery","document","querySelector","input","sentinel","refs","data","markup","ImagesApiServer","this","searchQuery","page","img","fetchGallery","fetch","BASE_URL","response","json","incrementPage","resetPage","newQuery","formTpl","insertAdjacentHTML","imagesApiServer","addEventListener","debounce","event","target","nodeName","changeModalImage","dataset","source","basicLightbox","show","observer","IntersectionObserver","entries","console","log","forEach","entry","isIntersecting","query","then","checkRender","rootMargin","e","preventDefault","value","trim","innerHTML","totalHits","observe","imagesTpl","renderImagesGallery","hits","length","unobserve","Handlebars","module","exports","template","container","depth0","helpers","partials","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","program","noop"],"mappings":"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","file":"main.bf88f17e54f9c46ab49e.js","sourcesContent":["export default function getRefs() {\r\n  return {\r\n  gallery: document.querySelector('.gallery'),\r\n  input: document.querySelector('#search-form-input'),\r\n  sentinel: document.querySelector('#sentinel'),\r\n  }\r\n}","import formTpl from '../templates/form.hbs';\r\nimport getRefs from '../js/getRefs';\r\n\r\nconst refs = getRefs();\r\n\r\nexport default function renderForm(data) {\r\n  const markup = formTpl(data);\r\n  refs.gallery.insertAdjacentHTML('beforebegin', markup);\r\n}","import imagesTpl from '../templates/images.hbs';\r\nimport getRefs from '../js/getRefs';\r\n\r\nconst refs = getRefs();\r\n\r\nexport default function renderImagesGallery(data) {\r\n  const markup = imagesTpl(data);\r\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\r\n}","const BASE_URL = 'https://pixabay.com/api';\r\nconst KEY = '19150317-d8041bc31c78eccc0e4f69a2b';\r\n\r\nexport default class ImagesApiServer {\r\n  constructor() {\r\n    this.searchQuery;\r\n    this.page = 1;\r\n    this.img = 0;\r\n  }\r\n  // fetchGallery() {\r\n  //   return fetch(`${BASE_URL}/?image_type=photo&orientation=horizontal&q=${this.searchQuery}&page=${this.page}&per_page=3&key=${KEY}`)\r\n  //     .then(res => { return res.json() })\r\n  // }\r\n  async fetchGallery() {\r\n    const response = await fetch(`${BASE_URL}/?image_type=photo&orientation=horizontal&q=${this.searchQuery}&page=${this.page}&per_page=12&key=${KEY}`);\r\n    const data = await response.json();\r\n    // console.log(data);\r\n    return data;\r\n  }\r\n\r\n  incrementPage() {\r\n    this.page += 1;\r\n  }\r\n  resetPage() {\r\n    this.page = 1;\r\n    this.img = 0;\r\n  }\r\n  get query() {\r\n    return this.searchQuery;\r\n  }\r\n  set query(newQuery) {\r\n    this.searchQuery = newQuery;\r\n  }\r\n}","import './styles.css';\nimport getRefs from './js/getRefs';\nimport renderForm from './js/renderForm';\nimport renderImagesGallery from './js/renderImagesGallery';\nimport ImagesApiServer from './js/apiService';\n// import LoadMoreBtn from './js/loadMoreBtn';\nimport debounce from 'lodash.debounce';\nimport * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/dist/basicLightbox.min.css';\n\n\nrenderForm();\nconst refs = getRefs();\n\nconst imagesApiServer = new ImagesApiServer();\n\n// loadMoreBtn.refs.button.addEventListener('click', onLoadMore);\n// document.addEventListener('scroll', handleScroll);\nrefs.input.addEventListener('input', debounce(onSearchImages, 500));\nrefs.gallery.addEventListener('click', onGalleryElClick);\n\n// Данные для метода observer\n\nconst options = {\n    rootMargin: '100px'\n}\nconst observer = new IntersectionObserver (onEntry, options);\n\n// Функция поиска каринок\n\nasync function onSearchImages(e) {\n  e.preventDefault();\n  imagesApiServer.query = e.target.value.trim();\n\n  refs.gallery.innerHTML = '';\n  if (!imagesApiServer.query) return;\n\n  // loadMoreBtn.show();\n  try {\n  const reset = await imagesApiServer.resetPage();\n  const addImages = await imagesApiServer.fetchGallery()\n  .then(checkRender)\n  } catch (error) {\n  console.log(error)\n  };\n}\n\nfunction checkRender(e) {\n  if (imagesApiServer.img < e.totalHits) {\n    observer.observe(refs.sentinel);\n    renderImagesGallery(e.hits);\n    imagesApiServer.img += e.hits.length;\n  }\n\n  if (imagesApiServer.img === e.totalHits) {\n    observer.unobserve(refs.sentinel);\n      return;\n    }\n}\n\n// Бесконечный скрол - 2\n\nfunction onEntry(entries) {\n  console.log('dsadsa', entries);\n    entries.forEach(entry => {\n        if (entry.isIntersecting && imagesApiServer.query !== '') {\n          console.log(\"LOADING...\");\n          imagesApiServer.incrementPage();\n          imagesApiServer.fetchGallery().then(checkRender);\n        }\n    });\n}\n\nfunction onGalleryElClick(event) {\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n  const changeModalImage = `<img src='${event.target.dataset.source}' alt=\"icon\" />`;\n  const instance = basicLightbox.create(changeModalImage);\n  instance.show();\n}\n\n      // Настройки кнопки \"Показать ещё\" при её использовании\n\n// const loadMoreBtn = new LoadMoreBtn({\n//   selector: '[data-action=\"load-more\"]',\n//   hidden: true,\n// });\n\n        // Функция добавления новых картинок на странице\n\n// async function onLoadMore(e) {\n//   if (isLoading) {\n//   return;\n//   }\n//   isLoading = true;\n//   if (!imagesApiServer.query) return;\n\n//   try {\n//   const increment = await imagesApiServer.incrementPage();\n//   const addImages = await imagesApiServer.fetchGallery()\n//     .then(checkRender)\n//     // .then(scrollPage)\n//     .then(() => isLoading = false)\n// } catch (error) {\n//   console.log(error)\n//   };\n// }\n\n              // Бесконечный скрол - 1 //\n\n// let isLoading = false;\n\n// function handleScroll(e) {\n//   const st = window.pageYOffset + window.innerHeight;\n\n//   if (window.scrollY + window.innerHeight + 400 > document.documentElement.scrollHeight) {\n//     onLoadMore();\n//   }\n// }\n\n           // Функция автоматического скрола //\n\n// function scrollPage() {\n//   try {\n//     setTimeout(() => {\n//       window.scrollTo({\n//         top: document.body.scrollHeight,\n//         left: 0,\n//         behavior: 'smooth',\n//       });\n//     }, 1000);\n//   } catch (error) {\n//     console.log(error);\n//   }\n// }\n\n\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"photo-card\\\">\\r\\n  <img src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":31,\"column\":12},\"end\":{\"line\":31,\"column\":28}}}) : helper)))\n    + \"\\\" data-source=\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"largeImageURL\") || (depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":31,\"column\":42},\"end\":{\"line\":31,\"column\":59}}}) : helper)))\n    + \" alt=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"tags\") || (depth0 != null ? lookupProperty(depth0,\"tags\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"tags\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":31,\"column\":65},\"end\":{\"line\":31,\"column\":73}}}) : helper)))\n    + \"\\\" width=\\\"400\\\" />\\r\\n\\r\\n  <div class=\\\"stats\\\">\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">thumb_up</i>\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":35,\"column\":44},\"end\":{\"line\":35,\"column\":53}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">visibility</i>\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":38,\"column\":46},\"end\":{\"line\":38,\"column\":55}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">comment</i>\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":41,\"column\":43},\"end\":{\"line\":41,\"column\":55}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">cloud_download</i>\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":44,\"column\":50},\"end\":{\"line\":44,\"column\":63}}}) : helper)))\n    + \"\\r\\n    </p>\\r\\n  </div>\\r\\n</div>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"\\r\\n\\r\\n\"\n    + ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":29,\"column\":0},\"end\":{\"line\":48,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<form class=\\\"search-form\\\" id=\\\"search-form\\\">\\r\\n  <input type=\\\"text\\\" id=\\\"search-form-input\\\" name=\\\"query\\\" autocomplete=\\\"off\\\" placeholder=\\\"Search images...\\\" />\\r\\n</form>\";\n},\"useData\":true});"],"sourceRoot":""}